(self.webpackChunkcircle=self.webpackChunkcircle||[]).push([[455],{8242:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return B}});var a=r(4942),s=r(1413),o=r(9439),t="login_loginContainer__hNAAS",c="login_loginLayout__-zivO",i="login_loginIcon__v0Xrs",l="login_loginText__2xzmB",u="login_isLogging__ZGX3K",g="login_loginMain__pVBUC",f="login_usernameInput__6Wjwe",p="login_loginButton__G+Y7+",m="login_loginDisable__WDLGT",d="login_isLoggingInput__Bcm6F",_="login_agreement__unp1s",h="login_agreeText__Nl0QJ",v="login_loginTips__ZlfRX",x="login_link__+a6GP",j="login_defaultIcon__aSM6W",Z=r(3695),w=r(8678),I=r(7083),b=r(2791),N=r(7106),k=r(8687),y=r(7411),S=r(6871),U=r(1091),L=r(7196),O=r(184),C=function(){return(0,O.jsx)(N.Z,{style:{fontSize:24,color:"#fff"}})},P="\u767b\u5f55\u73af\u4fe1\u5708\u5b50",z="\u8bf7\u8f93\u5165\u60a8\u7684\u624b\u673a\u53f7",T="\u767b\u5f55",A=JSON.parse(localStorage.getItem("userInfo"))||{};var B=(0,b.memo)((0,k.$j)((function(e){var n=e.app;return{isLogging:n.isLogging,loginSuccess:n.loginSuccess,appUserInfo:n.appUserInfo,userInfo:n.userInfo}}),(function(e){return{setLoginStatus:function(n){return e({type:"app/setLoginStatus",payload:n})},setUserInfo:function(n){return e({type:"app/setUserInfo",payload:n})},setAppUserInfo:function(n){return e({type:"app/setAppUserInfo",payload:n})}}}))((function(e){var n=e.isLogging,r=e.loginSuccess,N=e.setUserInfo,k=e.setLoginStatus,B=e.appUserInfo,J=e.userInfo,D=e.setAppUserInfo,G=(0,S.s0)();(0,b.useEffect)((function(){r&&n&&(k(!1),G("/main",{replace:!0}))}),[n,r,G,k]);var W=(0,b.useState)(Object.assign({username:"",password:"",agree:!1},A)),X=(0,o.Z)(W,2),E=X[0],M=X[1],$=function(e){return function(n){var r=n.target.value;"username"===e?r=r.replace(/[^\d]/g,""):"agree"===e&&(r=!E.agree),M((0,s.Z)((0,s.Z)({},E),{},(0,a.Z)({},e,r)))}},F=(0,b.useCallback)((function(){""!==E.username&&(E.username?/^1\d{10}$/.test(E.username)?E.agree?y.Z.conn.open({user:E.username,pwd:L.Iv}).then((function(e){var n=e.accessToken,r={username:E.username,accessToken:n,agree:!0};localStorage.setItem("userInfo",JSON.stringify(r)),N(r),k(!0),Z.ZP.destroy(),y.Z.conn.fetchUserInfoById(E.username).then((function(e){var n=(0,s.Z)({},e.data[E.username]),o=(0,s.Z)((0,s.Z)({},r),n);N(o),localStorage.setItem("userInfo",JSON.stringify(o));var t=(0,s.Z)((0,s.Z)({},n),{},{uid:E.username});D((0,s.Z)((0,s.Z)({},B),{},(0,a.Z)({},E.username,t)))}))})).catch((function(e){var n;console.log(e,"err"),"user not found"===(null!==(n=e.data)&&void 0!==n&&n.data?JSON.parse(e.data.data):"").error_description?y.Z.conn.registerUser({username:E.username,password:L.Iv}).then((function(e){F()})).catch((function(e){k(!1),Z.ZP.warn({content:"\u6ce8\u518c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01"})})):(k(!1),Z.ZP.warn({content:"\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\uff01"}))})):Z.ZP.warn({content:(0,O.jsxs)("span",{children:["\u4f53\u9a8c\u672cDemo\u60a8\u9700\u8981\u540c\u610f",(0,O.jsx)("a",{target:"_blank",href:"https://www.easemob.com/terms/im",rel:"noreferrer",children:"\u300a\u73af\u4fe1\u670d\u52a1\u6761\u6b3e\u300b"}),"\u4e0e",(0,O.jsx)("a",{target:"_blank",href:"https://www.easemob.com/protocol",rel:"noreferrer",children:"\u300a\u73af\u4fe1\u9690\u79c1\u534f\u8bae\u300b"}),"\u3002"]})}):Z.ZP.warn({content:"\u8bf7\u8f93\u5165\u5408\u6cd5\u624b\u673a\u53f7\uff01"}):Z.ZP.warn({content:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\uff01"}))}),[E.username,E.agree,k,N,D,B]);return(0,b.useEffect)((function(){J&&(window.location="/")}),[]),(0,O.jsx)("div",{className:t,children:(0,O.jsxs)("div",{className:c,children:[(0,O.jsx)("div",{className:i}),(0,O.jsx)("div",{className:l,children:P}),(0,O.jsxs)("div",{className:g,children:[(0,O.jsx)(w.Z,{disabled:n,value:E.username,className:"".concat(f," ").concat(n?d:null),placeholder:z,allowClear:{clearIcon:(0,O.jsx)(U.Z,{name:"xmark_in_circle",color:"#979797",size:"22px"})},maxLength:11,onChange:$("username")}),(0,O.jsx)("div",{className:"".concat(p," ").concat(""===E.username?m:null),onClick:F,children:n?(0,O.jsx)(I.Z,{indicator:(0,O.jsx)(C,{})}):(0,O.jsx)("span",{children:T})})]}),(0,O.jsxs)("div",{className:"".concat(_," ").concat(n?u:null),children:[(0,O.jsxs)("p",{className:h,children:[(0,O.jsx)("span",{className:"".concat(j),onClick:$("agree"),children:E.agree?(0,O.jsx)(U.Z,{name:"check_in_circle",size:"22px",color:"#16D265"}):(0,O.jsx)(U.Z,{name:"circle",size:"22px",color:"#979797"})}),"\u540c\u610f",(0,O.jsx)("a",{className:x,target:"_blank",href:"https://www.easemob.com/terms/im",rel:"noreferrer",children:"\u300a\u73af\u4fe1\u670d\u52a1\u6761\u6b3e\u300b"}),"\u4e0e",(0,O.jsx)("a",{className:x,target:"_blank",href:"https://www.easemob.com/protocol",rel:"noreferrer",children:"\u300a\u73af\u4fe1\u9690\u79c1\u534f\u8bae\u300b"}),"\uff0c"]}),(0,O.jsx)("p",{className:v,children:"\u672a\u6ce8\u518c\u624b\u673a\u53f7\u767b\u9646\u6210\u529f\u540e\u5c06\u81ea\u52a8\u6ce8\u518c\u3002"})]})]})})})))},9613:function(e){e.exports=function(e,n,r,a){var s=r?r.call(a,e,n):void 0;if(void 0!==s)return!!s;if(e===n)return!0;if("object"!==typeof e||!e||"object"!==typeof n||!n)return!1;var o=Object.keys(e),t=Object.keys(n);if(o.length!==t.length)return!1;for(var c=Object.prototype.hasOwnProperty.bind(n),i=0;i<o.length;i++){var l=o[i];if(!c(l))return!1;var u=e[l],g=n[l];if(!1===(s=r?r.call(a,u,g,l):void 0)||void 0===s&&u!==g)return!1}return!0}}}]);
//# sourceMappingURL=455.da97075c.chunk.js.map