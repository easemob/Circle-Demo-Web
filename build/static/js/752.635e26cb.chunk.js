"use strict";(self.webpackChunkcircle=self.webpackChunkcircle||[]).push([[752],{8967:function(n,e,s){s.d(e,{Z:function(){return r}});var a=s(2791),i=s(1091),t="index_close__A4OxI",c=s(184),o=function(){return(0,c.jsx)("span",{className:t,children:(0,c.jsx)(i.Z,{name:"xmark",color:"#C7C7C7",size:"18px"})})},r=(0,a.memo)(o)},5752:function(n,e,s){s.r(e),s.d(e,{default:function(){return W}});var a=s(2791),i=s(6871),t="index_userInfo__UPZsC",c=s(4942),o=s(1413),r=s(9439),l={sideBarWrap:"index_sideBarWrap__u3s9J",info:"index_info__cc8EU",avatar:"index_avatar__7dEXf",cover:"index_cover__hQjOa",edit:"index_edit__ehU8A",nickname:"index_nickname__TZwWn",uid:"index_uid__XKvmx",operationList:"index_operationList__qtti5",operationItem:"index_operationItem__H6a2n",userInfo:"index_userInfo__vxx1Y",text:"index_text__IWpO3",logout:"index_logout__T1FsX",logoutIcon:"index_logoutIcon__kn-li",logoutText:"index_logoutText__OCPQI",logoutCon:"index_logoutCon__YqWQ3",content:"index_content__3qp8v",buttons:"index_buttons__QMNO7",confirm:"index_confirm__nYc+P"},d=s(2718),u=s(8687),x=s(7411),p=s(3695),m=s(5873),f=s(4165),_=s(5861),h=s(9553),j=s(6658),v="index_confirmBtn__JyQ1g",N=s(1102),I=s.n(N),Z=s(184),C=function(){return(0,Z.jsx)("div",{className:"circleBtn ".concat(v),children:"\u786e\u8ba4"})},k=function(){return(0,Z.jsx)("div",{className:"circleBtnGray ".concat(v),children:"\u53d6\u6d88"})},U=function(n){var e=n.update,s=n.innerNode,a={showUploadList:!1,maxCount:1,action:"".concat(x.Z.conn.apiUrl,"/").concat(x.Z.conn.orgName,"/").concat(x.Z.conn.appName,"/chatfiles"),onChange:function(n){var s=n.fileList[0],a="";"done"===s.status&&s.response.entities&&s.response.entities[0]&&(a=s.response.uri+"/"+s.response.entities[0].uuid,e(a))},beforeUpload:function(n){return new Promise(function(){var e=(0,_.Z)((0,f.Z)().mark((function e(s){var a;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I()(n);case 3:a=e.sent,s(a.file),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),Error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n){return e.apply(this,arguments)}}())}};return(0,Z.jsx)("div",{children:(0,Z.jsx)(j.Z,{modalTitle:"\u4e0a\u4f20\u5934\u50cf",modalWidth:960,modalHeight:572,modalOk:(0,Z.jsx)(C,{}),modalCancel:(0,Z.jsx)(k,{}),quality:.2,maxZoom:2,children:(0,Z.jsx)(h.Z,(0,o.Z)((0,o.Z)({},a),{},{children:s}))})})},g=(0,a.memo)(U),y=s(1091),b=s(8967),w=s(8406),B=[{op:"userInfo",title:"\u4e2a\u4eba\u8d44\u6599",iconName:"person_normal"}],O=(0,a.memo)((0,u.$j)((function(n){var e=n.app;return{userInfo:e.userInfo,appUserInfo:e.appUserInfo}}),(function(n){return{setUserInfo:function(e){return n({type:"app/setUserInfo",payload:e})},setAppUserInfo:function(e){return n({type:"app/setAppUserInfo",payload:e})}}}))((function(n){var e=n.userInfo,s=n.setUserInfo,i=n.appUserInfo,t=n.setAppUserInfo,u=(0,a.useState)(!1),f=(0,r.Z)(u,2),_=f[0],h=f[1],j=function(){h(!1)};return(0,Z.jsxs)("div",{className:l.sideBarWrap,children:[(0,Z.jsxs)("div",{className:l.info,children:[(0,Z.jsx)("div",{className:l.avatar,children:(0,Z.jsx)(g,{update:function(n){x.Z.conn.updateUserInfo({avatarurl:n}).then((function(n){s(Object.assign((0,o.Z)({},e),{avatarurl:n.data.avatarurl})),t((0,o.Z)((0,o.Z)({},i),{},(0,c.Z)({},e.username,(0,o.Z)((0,o.Z)({},i[e.username]),n.data))))})).catch((function(n){p.ZP.warn({content:"\u5934\u50cf\u4fee\u6539\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01"})}))},innerNode:(0,Z.jsxs)("div",{children:[(0,Z.jsx)(d.Z,{size:90,src:e.avatarurl}),(0,Z.jsx)("div",{className:l.cover}),(0,Z.jsx)("span",{className:l.edit,children:(0,Z.jsx)(y.Z,{name:"pencil",size:"32px",color:"#fff"})})]})})}),(0,Z.jsx)("span",{className:l.nickname,children:e.nickname||e.username}),(0,Z.jsxs)("span",{className:l.uid,children:["\u73af\u4fe1ID\uff1a",e.username]}),(0,Z.jsx)("div",{className:l.operationList,children:B.length>0&&B.map((function(n){return(0,Z.jsxs)("div",{className:l.operationItem,children:[(0,Z.jsx)("span",{className:"".concat(l[n.op]),children:(0,Z.jsx)(y.Z,{name:n.iconName,size:"24px"})}),(0,Z.jsx)("span",{className:l.text,children:n.title})]},n)}))})]}),(0,Z.jsxs)("div",{className:l.logout,onClick:function(){h(!0)},children:[(0,Z.jsx)("span",{className:l.logoutIcon,children:(0,Z.jsx)(y.Z,{name:"door",size:"22px"})}),(0,Z.jsx)("span",{className:l.logoutText,children:"\u9000\u51fa\u767b\u5f55"})]}),(0,Z.jsx)(m.Z,{className:"logoutModal",title:"\u9000\u51fa\u767b\u5f55",width:546,destroyOnClose:!0,maskClosable:!1,visible:_,onCancel:j,footer:null,closeIcon:(0,Z.jsx)(b.Z,{}),children:(0,Z.jsxs)("div",{className:l.logoutCon,children:[(0,Z.jsx)("span",{className:l.content,children:"\u786e\u8ba4\u9000\u51fa\u5417\uff1f\u4e0b\u6b21\u89c1\u54e6\uff01"}),(0,Z.jsxs)("div",{className:l.buttons,children:[(0,Z.jsx)("div",{className:"circleBtn106 circleBtnGray",onClick:j,children:"\u53d6\u6d88"}),(0,Z.jsx)("div",{className:"circleBtn106 circleBtn ".concat(l.confirm),onClick:function(){x.Z.conn.close(),h(!1),(0,w.a8)(),window.location.href="/"},children:"\u786e\u8ba4"})]})]})})]})}))),L={container:"index_container__72Ty7",header:"index_header__v8p8u",icon:"index_icon__LuQ49",text:"index_text__CffCe",main:"index_main__GlhNZ",item:"index_item__fzLsY",nickname:"index_nickname__FxKG-",edit:"index_edit__Unt24",updateNickname:"index_updateNickname__ffDbL",title:"index_title__PDUo9",updateCon:"index_updateCon__3mMdC",input:"index_input__5LI3o",count:"index_count__35k-m",confirm:"index_confirm__iWapD"},A=(0,a.memo)((0,u.$j)((function(n){var e=n.app;return{userInfo:e.userInfo,appUserInfo:e.appUserInfo}}),(function(n){return{setUserInfo:function(e){return n({type:"app/setUserInfo",payload:e})},setAppUserInfo:function(e){return n({type:"app/setAppUserInfo",payload:e})}}}))((function(n){var e=n.userInfo,s=n.setUserInfo,i=n.appUserInfo,t=n.setAppUserInfo,l=(0,a.createRef)(),d=(0,a.useState)(!1),u=(0,r.Z)(d,2),f=u[0],_=u[1];(0,a.useEffect)((function(){setTimeout((function(){f&&(null===l||void 0===l?void 0:l.current)&&l.current.focus()}),0)}),[f,l]),(0,a.useEffect)((function(){localStorage.setItem("userInfo",JSON.stringify(e))}),[e]);var h=(0,a.useState)(""),j=(0,r.Z)(h,2),v=j[0],N=j[1];return(0,Z.jsxs)("div",{className:L.container,children:[(0,Z.jsxs)("div",{className:L.header,children:[(0,Z.jsx)("span",{className:L.icon,children:(0,Z.jsx)(y.Z,{name:"person_normal",size:"24px"})}),(0,Z.jsx)("span",{className:L.text,children:"\u4e2a\u4eba\u8d44\u6599"})]}),(0,Z.jsx)("div",{className:L.main,children:(0,Z.jsxs)("div",{className:L.item,children:[(0,Z.jsxs)("div",{className:L.info,children:[(0,Z.jsx)("span",{children:"\u6211\u7684\u6635\u79f0"}),(0,Z.jsx)("span",{className:L.nickname,children:e.nickname||e.username})]}),(0,Z.jsx)("div",{className:L.edit,onClick:function(){_(!0),N((null===e||void 0===e?void 0:e.nickname)||"")},children:"\u7f16\u8f91"})]})}),(0,Z.jsx)(m.Z,{className:"userInfoModal",destroyOnClose:!0,title:"\u66f4\u6539\u6635\u79f0",visible:f,onCancel:function(){_(!1)},footer:null,closeIcon:(0,Z.jsx)(b.Z,{}),children:(0,Z.jsxs)("div",{className:L.updateNickname,children:[(0,Z.jsx)("span",{className:L.title,children:"\u6635\u79f0"}),(0,Z.jsxs)("div",{className:L.updateCon,children:[(0,Z.jsx)("input",{ref:l,className:L.input,value:v,maxLength:16,onChange:function(n){return function(n){N(n.target.value)}(n)},placeholder:"\u8bf7\u8f93\u5165\u6635\u79f0"}),(0,Z.jsxs)("span",{className:L.count,children:[v.length,"/16"]})]}),(0,Z.jsx)("div",{className:"circleBtn circleBtn106 ".concat(L.confirm," ").concat(""===v?"disable":null),onClick:function(){""!==v&&(x.Z.conn.updateUserInfo({nickname:v}).then((function(n){s(Object.assign((0,o.Z)({},e),n.data)),t((0,o.Z)((0,o.Z)({},i),{},(0,c.Z)({},e.username,(0,o.Z)((0,o.Z)({},i[e.username]),n.data))))})).catch((function(n){p.ZP.warn({content:"\u6635\u79f0\u4fee\u6539\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01"})})),N(""),_(!1))},children:"\u786e\u8ba4"})]})})]})}))),T=function(n){return(0,Z.jsxs)("div",{className:t,children:[(0,Z.jsx)(O,{}),(0,Z.jsx)(A,{}),(0,Z.jsx)(i.j3,{})]})},W=(0,a.memo)(T)}}]);
//# sourceMappingURL=752.635e26cb.chunk.js.map