/*! For license information please see 275.493824b6.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkcircle=self.webpackChunkcircle||[]).push([[275],{1269:function(e,n,t){t.d(n,{Z:function(){return h}});var r="index_info__ZJIn6",i="index_defaultStyle__+aVsA",o="index_name__DW1g1",a="index_all__JUGKz",s="index_online__pBQbe",l="index_offline__nm8iG",c=t(2791),d=t(184),u=function(e){var n=e.online,t=e.name,c=e.showOnline;return(0,d.jsxs)("div",{className:r,children:[(0,d.jsx)("span",{className:"".concat(i," ").concat(c?o:a),children:t}),c&&(0,d.jsx)("span",{className:"".concat(s," ").concat(n?null:l),children:n?"\u5728\u7ebf":"\u79bb\u7ebf"})]})},h=(0,c.memo)(u)},149:function(e,n,t){t.d(n,{Z:function(){return x}});var r=t(9439),i=t(1269),o=t(2718),a="index_contactsItem__td4Mf",s="index_selected__gwyZ5",l="index_contactsItem2__cp+N3",c="index_mainInfo__5wuox",d="index_avatar__jTpQV",u="index_type2__rGTXq",h="index_basicInfo__B8XcK",p="index_operation__-G2DM",v=t(2791),f=t(184),m=function(e){var n=e.info,t=e.uid,m=e.operationReactNode,x=e.handlerHover,_=e.borderType,g=e.basicShowOnline,y=e.size,I=(0,v.useRef)(),b=(0,v.useState)(!1),C=(0,r.Z)(b,2),Z=C[0],j=C[1];return(0,v.useEffect)((function(){var e=function(e){var n=I.current;n&&(n.contains(e.target)?j(!0):j(!1))};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[]),(0,f.jsxs)("div",{className:"memberItem ".concat(a," ").concat(Z?s:2===_?l:null," "),onMouseOver:function(){x&&x(null===n||void 0===n?void 0:n.uid)},onMouseLeave:function(){x&&x("")},children:[(0,f.jsx)("div",{className:d,children:(0,f.jsx)(o.Z,{size:y,name:(null===n||void 0===n?void 0:n.nickname)||t,src:null===n||void 0===n?void 0:n.avatarurl,online:null===n||void 0===n?void 0:n.online})}),(0,f.jsxs)("div",{className:"".concat(c," ").concat(2===_?u:null),children:[(0,f.jsx)("div",{className:h,children:(0,f.jsx)(i.Z,{name:(null===n||void 0===n?void 0:n.nickname)||t,src:null===n||void 0===n?void 0:n.avatarurl,online:null===n||void 0===n?void 0:n.online,showOnline:g})}),(0,f.jsx)("div",{className:p,ref:I,children:m})]})]})},x=(0,v.memo)(m)},2275:function(e,n,t){t.r(n),t.d(n,{default:function(){return un}});var r=t(2791),i=t(6871),o="index_contentWrap__L6LYm",a="index_menuWrap__jRwb1",s=t(1413),l=t(3433),c=t(9439),d=t(7462),u=t(4942),h=t(1938),p=t(1694),v=t.n(p),f=t(5671),m=t(3144),x=t(9340),_=t(8557),g=t(1002),y=t(9613),I=t.n(y),b=t(5501),C=t(5207),Z=r.forwardRef((function(e,n){var t,i=e.prefixCls,o=e.forceRender,a=e.className,s=e.style,l=e.children,d=e.isActive,h=e.role,p=r.useState(d||o),f=(0,c.Z)(p,2),m=f[0],x=f[1];return r.useEffect((function(){(o||d)&&x(!0)}),[o,d]),m?r.createElement("div",{ref:n,className:v()("".concat(i,"-content"),(t={},(0,u.Z)(t,"".concat(i,"-content-active"),d),(0,u.Z)(t,"".concat(i,"-content-inactive"),!d),t),a),style:s,role:h},r.createElement("div",{className:"".concat(i,"-content-box")},l)):null}));Z.displayName="PanelContent";var j=Z,T=function(e){(0,x.Z)(t,e);var n=(0,_.Z)(t);function t(){var e;(0,f.Z)(this,t);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=n.call.apply(n,[this].concat(o))).onItemClick=function(){var n=e.props,t=n.onItemClick,r=n.panelKey;"function"===typeof t&&t(r)},e.handleKeyPress=function(n){"Enter"!==n.key&&13!==n.keyCode&&13!==n.which||e.onItemClick()},e.renderIcon=function(){var n=e.props,t=n.showArrow,i=n.expandIcon,o=n.prefixCls,a=n.collapsible;if(!t)return null;var s="function"===typeof i?i(e.props):r.createElement("i",{className:"arrow"});return s&&r.createElement("div",{className:"".concat(o,"-expand-icon"),onClick:"header"===a?e.onItemClick:null},s)},e.renderTitle=function(){var n=e.props,t=n.header,i=n.prefixCls,o=n.collapsible;return r.createElement("span",{className:"".concat(i,"-header-text"),onClick:"header"===o?e.onItemClick:null},t)},e}return(0,m.Z)(t,[{key:"shouldComponentUpdate",value:function(e){return!I()(this.props,e)}},{key:"render",value:function(){var e,n,t=this.props,i=t.className,o=t.id,a=t.style,s=t.prefixCls,l=t.headerClass,c=t.children,h=t.isActive,p=t.destroyInactivePanel,f=t.accordion,m=t.forceRender,x=t.openMotion,_=t.extra,g=t.collapsible,y="disabled"===g,I="header"===g,b=v()((e={},(0,u.Z)(e,"".concat(s,"-item"),!0),(0,u.Z)(e,"".concat(s,"-item-active"),h),(0,u.Z)(e,"".concat(s,"-item-disabled"),y),e),i),Z={className:v()("".concat(s,"-header"),(n={},(0,u.Z)(n,l,l),(0,u.Z)(n,"".concat(s,"-header-collapsible-only"),I),n)),"aria-expanded":h,"aria-disabled":y,onKeyPress:this.handleKeyPress};I||(Z.onClick=this.onItemClick,Z.role=f?"tab":"button",Z.tabIndex=y?-1:0);var T=null!==_&&void 0!==_&&"boolean"!==typeof _;return r.createElement("div",{className:b,style:a,id:o},r.createElement("div",Z,this.renderIcon(),this.renderTitle(),T&&r.createElement("div",{className:"".concat(s,"-extra")},_)),r.createElement(C.Z,(0,d.Z)({visible:h,leavedClassName:"".concat(s,"-content-hidden")},x,{forceRender:m,removeOnLeave:p}),(function(e,n){var t=e.className,i=e.style;return r.createElement(j,{ref:n,prefixCls:s,className:t,style:i,isActive:h,forceRender:m,role:f?"tabpanel":null},c)})))}}]),t}(r.Component);T.defaultProps={showArrow:!0,isActive:!1,onItemClick:function(){},headerClass:"",forceRender:!1};var N=T;function S(e){var n=e;if(!Array.isArray(n)){var t=(0,g.Z)(n);n="number"===t||"string"===t?[n]:[]}return n.map((function(e){return String(e)}))}var w=function(e){(0,x.Z)(t,e);var n=(0,_.Z)(t);function t(e){var i;(0,f.Z)(this,t),(i=n.call(this,e)).onClickItem=function(e){var n=i.state.activeKey;if(i.props.accordion)n=n[0]===e?[]:[e];else{var t=(n=(0,l.Z)(n)).indexOf(e);t>-1?n.splice(t,1):n.push(e)}i.setActiveKey(n)},i.getNewChild=function(e,n){if(!e)return null;var t=i.state.activeKey,o=i.props,a=o.prefixCls,s=o.openMotion,l=o.accordion,c=o.destroyInactivePanel,d=o.expandIcon,u=o.collapsible,h=e.key||String(n),p=e.props,v=p.header,f=p.headerClass,m=p.destroyInactivePanel,x=p.collapsible,_=null!==x&&void 0!==x?x:u,g={key:h,panelKey:h,header:v,headerClass:f,isActive:l?t[0]===h:t.indexOf(h)>-1,prefixCls:a,destroyInactivePanel:null!==m&&void 0!==m?m:c,openMotion:s,accordion:l,children:e.props.children,onItemClick:"disabled"===_?null:i.onClickItem,expandIcon:d,collapsible:_};return"string"===typeof e.type?e:(Object.keys(g).forEach((function(e){"undefined"===typeof g[e]&&delete g[e]})),r.cloneElement(e,g))},i.getItems=function(){var e=i.props.children;return(0,b.Z)(e).map(i.getNewChild)},i.setActiveKey=function(e){"activeKey"in i.props||i.setState({activeKey:e}),i.props.onChange(i.props.accordion?e[0]:e)};var o=e.activeKey,a=e.defaultActiveKey;return"activeKey"in e&&(a=o),i.state={activeKey:S(a)},i}return(0,m.Z)(t,[{key:"shouldComponentUpdate",value:function(e,n){return!I()(this.props,e)||!I()(this.state,n)}},{key:"render",value:function(){var e,n=this.props,t=n.prefixCls,i=n.className,o=n.style,a=n.accordion,s=v()((e={},(0,u.Z)(e,t,!0),(0,u.Z)(e,i,!!i),e));return r.createElement("div",{className:s,style:o,role:a?"tablist":null},this.getItems())}}],[{key:"getDerivedStateFromProps",value:function(e){var n={};return"activeKey"in e&&(n.activeKey=S(e.activeKey)),n}}]),t}(r.Component);w.defaultProps={prefixCls:"rc-collapse",onChange:function(){},accordion:!1,destroyInactivePanel:!1},w.Panel=N;var E=w,k=(w.Panel,t(1818)),M=t(1929),L=t(9464),P=t(1113),A=function(e){var n,t=r.useContext(M.E_),i=t.getPrefixCls,o=t.direction,a=e.prefixCls,s=e.className,l=void 0===s?"":s,c=e.bordered,p=void 0===c||c,f=e.ghost,m=e.expandIconPosition,x=void 0===m?"start":m,_=i("collapse",a),g=r.useMemo((function(){return"left"===x?"start":"right"===x?"end":x}),[x]),y=v()("".concat(_,"-icon-position-").concat(g),(n={},(0,u.Z)(n,"".concat(_,"-borderless"),!p),(0,u.Z)(n,"".concat(_,"-rtl"),"rtl"===o),(0,u.Z)(n,"".concat(_,"-ghost"),!!f),n),l),I=(0,d.Z)((0,d.Z)({},L.ZP),{motionAppear:!1,leavedClassName:"".concat(_,"-content-hidden")});return r.createElement(E,(0,d.Z)({openMotion:I},e,{expandIcon:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.expandIcon,i=t?t(n):r.createElement(h.Z,{rotate:n.isActive?90:void 0});return(0,P.Tm)(i,(function(){return{className:v()(i.props.className,"".concat(_,"-arrow"))}}))},prefixCls:_,className:y}),function(){var n=e.children;return(0,b.Z)(n).map((function(e,n){var t;if(null===(t=e.props)||void 0===t?void 0:t.disabled){var r=e.key||String(n),i=e.props,o=i.disabled,a=i.collapsible,s=(0,d.Z)((0,d.Z)({},(0,k.Z)(e.props,["disabled"])),{key:r,collapsible:null!==a&&void 0!==a?a:o?"disabled":void 0});return(0,P.Tm)(e,s)}return e}))}())};A.Panel=function(e){var n=r.useContext(M.E_).getPrefixCls,t=e.prefixCls,i=e.className,o=void 0===i?"":i,a=e.showArrow,s=void 0===a||a,l=n("collapse",t),c=v()((0,u.Z)({},"".concat(l,"-no-arrow"),!s),o);return r.createElement(E.Panel,(0,d.Z)({},e,{prefixCls:l,className:c}))};var R=A,D=t(6573),O=t(3695),K=t(2570),Y="index_sideBarWrap__rgKxW",z="index_serverCover__P60zr",V="index_shadow__Aluxd",W="index_infoWrap__DgqiN",F="index_serverName__pGWmh",B="index_iconWarp__vwFF-",U="index_icon__x7O2L",H="index_tagWrap__SkOja",G="index_channelWrap__B5UyB",q="index_customCollapse__RgtW+",X="index_customCollapsePanel__+IgIl",$="index_headerWrap__qa3eN",J="index_addIcon__-Re+P",Q="index_serverContentWrap__cgM1G",ee="index_desc__zXi5n",ne="index_textHeader__unq9L",te="index_channelItemWrap__gCREo",re="index_active__byk6K",ie="index_channel__7g5KV",oe="index_channelNameWrap__yAh7K",ae="index_name__SGyTF",se="index_public__Ji8u6",le="index_private__gNpPk",ce="index_unReadCount__Sjb9c",de="index_unReadWrap__CiTVK",ue="index_threadItem__Ybs1B",he="index_threadActive__xsBBb",pe="index_threadName__bTY7s",ve="index_loadBtn__vKW0+",fe="index_channelContentWrap__9KrOM",me="index_expand__VMJSw",xe="index_fold__F8nOT",_e="index_tagItem__zPxp1",ge="index_expandIcon__Ixtxl",ye=t(1091),Ie=t(184),be=function(e){var n=e.desc,t=void 0===n?"":n,i=(0,r.useState)(!1),o=(0,c.Z)(i,2),a=o[0],s=o[1],l=(null===t||void 0===t?void 0:t.length)>38,d="".concat(null===t||void 0===t?void 0:t.substring(0,38),"...");return(0,Ie.jsx)("div",{className:Q,children:(0,Ie.jsx)("div",{className:ee,children:(0,Ie.jsxs)("span",{children:[!a&&l?d:t,l&&(0,Ie.jsx)("div",{className:ge,style:{transform:a?"rotate(180deg)":"rotate(0)"},onClick:function(){s(!a)},children:(0,Ie.jsx)(ye.Z,{name:"shevron_down"})})]})})})},Ce=(0,r.memo)(be),Ze=t(4165),je=t(5861),Te=t(7295),Ne=t(8687),Se=t(7411),we=t(8406),Ee=t(7196),ke=R.Panel,Me=function(e){var n=e.threadInfo,t=e.currentId===n.id;return(0,Ie.jsxs)("div",{className:t?"".concat(ue," ").concat(he):ue,children:[(0,Ie.jsx)("span",{className:pe,children:(0,Ie.jsx)("span",{className:ae,children:n.name})}),(0,Ie.jsx)("div",{style:{width:"38px",textAlign:"left"},children:(0,Ie.jsx)(ye.Z,{name:"shevron_right",color:"#858585",size:"14px"})})]})},Le=function(e){var n=e.onClick;return(0,Ie.jsxs)("div",{className:ve,onClick:n,children:["\u52a0\u8f7d\u66f4\u591a\u5b50\u533a",(0,Ie.jsx)(Te.Z,{style:{color:"#767676",fontSize:"12px",marginLeft:"2px"}})]})},Pe=function(e){var n=e.active,t=e.name,o=e.channelId,a=e.serverId,c=e.setThreadMap,d=e.threadMap,u=e.setThreadInfo,h=e.isPublic,p=e.setIsCreatingThread,v=e.chatMap,f=(0,i.UO)().threadId,m=(0,i.s0)(),x=(0,r.useMemo)((function(){return function(e){var n=e.channelId,t=void 0===n?"":n,r=e.threadMap;return(void 0===r?new Map:r).get(t)}({channelId:o,threadMap:d})}),[o,d]),_=(0,r.useCallback)(function(){var e=(0,je.Z)((0,Ze.Z)().mark((function e(n){var t,r,i,o,a,s;return(0,Ze.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.channelId,r=n.cursor,i=void 0===r?"":r,e.prev=1,e.next=4,Se.Z.conn.getChatThreads({parentId:t,pageSize:Ee.LI,cursor:i});case 4:o=e.sent,a=[],null!==x&&void 0!==x&&x.list?(s=(0,we.cm)(null===x||void 0===x?void 0:x.list,o.entities,"id"),a=[].concat((0,l.Z)(null===x||void 0===x?void 0:x.list),(0,l.Z)(s))):a=o.entities,c({channelId:t,threadInfo:{list:a,cursor:o.properties.cursor,loadCount:o.entities.length}}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n){return e.apply(this,arguments)}}(),[null===x||void 0===x?void 0:x.list,c]);(0,r.useEffect)((function(){d.has(o)||_({channelId:o,cursor:""})}),[o]);var g=function(e){var n,t;return(null===(n=v[Ee.zi.groupChat])||void 0===n||null===(t=n.get(e))||void 0===t?void 0:t.unReadNum)||0},y=g(o)>0;return(0,Ie.jsxs)("div",{className:te,children:[(0,Ie.jsxs)("div",{onClick:function(){m("/main/channel/".concat(a,"/").concat(o))},className:n?"".concat(ie," ").concat(re):ie,children:[(0,Ie.jsx)("span",{className:h?"".concat(oe," ").concat(se," "):"".concat(oe," ").concat(le),children:(0,Ie.jsx)("span",{className:ae,children:t})}),(0,Ie.jsxs)("div",{className:de,style:y?{marginRight:"18px"}:{},children:[y&&(0,Ie.jsx)("div",{className:ce,children:g(o)}),(0,Ie.jsx)(ye.Z,{name:"shevron_right",color:"#858585",size:"14px"})]})]}),(0,Ie.jsx)(R,{className:q,bordered:!1,defaultActiveKey:"1",expandIcon:function(e){var n=e.isActive;return(0,Ie.jsx)(ye.Z,{iconClass:n?me:xe,name:"shevron_down",color:"#767676",size:"14px"})},children:(null===x||void 0===x?void 0:x.list.length)&&(0,Ie.jsxs)(ke,{className:X,header:"\u5b50\u533a",children:[null===x||void 0===x?void 0:x.list.map((function(e){return(0,Ie.jsx)("div",{onClick:function(){return function(e){var n=(0,we.rS)(e.parentId,e.messageId),t=n?(0,s.Z)((0,s.Z)({},n),{},{chatThreadOverview:{}}):{};p(!1),u((0,s.Z)((0,s.Z)({},e),{},{parentMessage:t})),Se.Z.conn.joinChatThread({chatThreadId:e.id}).then((function(n){m("/main/channel/".concat(a,"/").concat(o,"/").concat(e.id))})).catch((function(n){1301===n.type?m("/main/channel/".concat(a,"/").concat(o,"/").concat(e.id)):1300===n.type&&O.ZP.warn({content:"\u8be5\u5b50\u533a\u5df2\u7ecf\u88ab\u9500\u6bc1"})}))}(e)},children:(0,Ie.jsx)(Me,{threadInfo:e,currentId:f})},e.id)})),(null===x||void 0===x?void 0:x.loadCount)===Ee.LI?(0,Ie.jsx)(Le,{onClick:function(){_({channelId:o,cursor:null===x||void 0===x?void 0:x.cursor})}}):(0,Ie.jsx)(Ie.Fragment,{})]},"1")})]})},Ae=(0,Ne.$j)((function(e){var n=e.app;return{threadMap:e.channel.threadMap,chatMap:n.chatMap}}),(function(e){return{setThreadMap:function(n){return e({type:"channel/setThreadMap",payload:n})},setThreadInfo:function(n){return e({type:"thread/setThreadInfo",payload:n})},setIsCreatingThread:function(n){return e({type:"thread/setIsCreatingThread",payload:n})}}}))((0,r.memo)(Pe)),Re=t(5873),De=t(6014),Oe="create",Ke="viewMember",Ye="editServer",ze="dissolveServer",Ve="leaveServer",We=[{label:(0,Ie.jsxs)("div",{className:a,children:[(0,Ie.jsx)(ye.Z,{name:"add_in_circle",size:"22px"}),(0,Ie.jsx)("span",{children:"\u521b\u5efa\u9891\u9053"})]}),key:Oe},{label:(0,Ie.jsxs)("div",{className:a,children:[(0,Ie.jsx)(ye.Z,{name:"person_2",size:"22px"}),(0,Ie.jsx)("span",{children:"\u67e5\u770b\u793e\u533a\u6210\u5458"})]}),key:Ke},{label:(0,Ie.jsxs)("div",{className:a,children:[(0,Ie.jsx)(ye.Z,{name:"gear",size:"22px"}),(0,Ie.jsx)("span",{children:"\u7f16\u8f91\u793e\u533a"})]}),key:Ye},{label:(0,Ie.jsxs)("div",{className:a,children:[(0,Ie.jsx)(ye.Z,{name:"trash",size:"22px"}),(0,Ie.jsx)("span",{children:"\u89e3\u6563\u793e\u533a"})]}),key:ze},{label:(0,Ie.jsxs)("div",{className:a,children:[(0,Ie.jsx)(ye.Z,{name:"door",size:"22px"}),(0,Ie.jsx)("span",{children:"\u9000\u51fa\u793e\u533a"})]}),key:Ve}],Fe=function(e){var n=[];switch(e){case Ee.N1.owner:n.push(We[0],We[1],We[2],We[3]);break;case Ee.N1.moderator:n.push(We[1],We[2],We[4]);break;case Ee.N1.user:n.push(We[1],We[4])}return n},Be="index_inviteModal__UpFms",Ue="index_iptWrap__b8dor",He="index_inviteBtn__glQhU",Ge="index_invited__Sy6ZY",qe="index_empty__GuoA7",Xe=t(8678),$e=t(149),Je=function(e){var n=e.isInvite,t=e.uid,r=e.serverId,i=e.onSend,o=e.type,a=e.channelId;return(0,Ie.jsx)("div",{children:n?(0,Ie.jsx)("div",{className:Ge,children:"\u5df2\u53d1\u9001"}):(0,Ie.jsx)("div",{className:"".concat(He," circleBtn"),onClick:function(){!function(e){var n=e.serverId,t=e.uid,r=e.onSend,i=e.channelId;e.type===Ee.ET.inviteServer?Se.Z.conn.inviteUserToServer({serverId:n,userId:t}).then((function(){r(),O.ZP.success("\u9080\u8bf7\u5df2\u53d1\u9001")})).catch((function(e){"User is already in server."===e.message&&O.ZP.info("\u7528\u6237\u5df2\u52a0\u5165\u793e\u533a")})):Se.Z.conn.inviteUserToChannel({serverId:n,channelId:i,userId:t,inviteMessage:"welcome"}).then((function(){r(),O.ZP.success("\u9080\u8bf7\u5df2\u53d1\u9001")})).catch((function(e){"User is already in channel."===e.message&&O.ZP.info("\u7528\u6237\u5df2\u52a0\u5165\u9891\u9053")}))}({serverId:r,channelId:a,uid:t,onSend:i,type:o})},children:"\u9080\u8bf7"})})},Qe=(0,r.memo)((0,Ne.$j)((function(e){var n=e.channel,t=e.app,r=e.contact,i=e.server;return{visible:n.inviteVisible,appUserInfo:t.appUserInfo,applyInfo:r.applyInfo,contactsList:r.contactsList,serverList:i.joinedServerInfo.list||[]}}),(function(e){return{setVisible:function(n){return e({type:"channel/setInviteVisible",payload:n})},setContactsList:function(n){return e({type:"contact/setContactsList",payload:n})},insertChatMessage:function(n){return e({type:"app/insertChatMessage",payload:n})}}}))((function(e){var n=e.visible,t=e.setVisible,o=e.serverName,a=void 0===o?"":o,l=e.channelName,d=void 0===l?"":l,u=e.contactsList,h=e.setContactsList,p=e.appUserInfo,v=e.serverList,f=e.insertChatMessage,m=(0,r.useState)({}),x=(0,c.Z)(m,2),_=x[0],g=x[1],y=(0,i.UO)(),I=y.serverId,b=y.channelId,C=(0,r.useState)(""),Z=(0,c.Z)(C,2),j=Z[0],T=Z[1],N=n===Ee.ET.inviteServer,S=(0,r.useCallback)((function(){var e={};u.length?u.forEach((function(n){e[n]={isInvite:!1,uid:n}})):Se.Z.conn.getContacts().then((function(n){n.data.length>0&&((0,we.mZ)(n.data),h(n.data),n.data.forEach((function(n){e[n]={isInvite:!1,uid:n}})))})),g(e)}),[u,h]);return(0,r.useEffect)((function(){n&&S()}),[n,S]),(0,Ie.jsxs)(Re.Z,{width:544,className:"".concat(Be),title:N?"\u9080\u8bf7\u597d\u53cb\u52a0\u5165\u793e\u533a  ".concat(a):"\u9080\u8bf7\u597d\u53cb\u52a0\u5165  ".concat(a," - ").concat(d,"\u9891\u9053"),visible:n,footer:null,closeIcon:(0,Ie.jsx)(ye.Z,{name:"xmark",color:"#c7c7c7",size:"16px"}),destroyOnClose:!0,onCancel:function(){T(""),t(!1)},children:[(0,Ie.jsxs)("div",{className:"".concat(Ue),children:[(0,Ie.jsx)(ye.Z,{name:"magnify",color:"#999"}),(0,Ie.jsx)(Xe.Z,{value:j,placeholder:"\u641c\u7d22\u597d\u53cb",autoComplete:"off",onInput:function(e){T(e.target.value)}})]}),Object.values(_).length>0?Object.values(_).filter((function(e){var n=p[e.uid];return(null===n||void 0===n?void 0:n.uid.includes(j))||(null===n||void 0===n?void 0:n.nickname.includes(j))})).map((function(e){return(0,Ie.jsx)($e.Z,{style:{padding:0},info:p[e.uid],uid:e.uid,operationReactNode:(0,Ie.jsx)(Je,(0,s.Z)((0,s.Z)({},e),{},{type:n,serverId:I,channelId:b,onSend:function(){!function(e,n,t){_[e].isInvite=!0,g((0,s.Z)({},_));var r={};if(N){var i=v.find((function(e){return e.id===I}));r=(0,we.bD)({chatType:Ee.zi.single,type:"custom",to:e,customEvent:Ee.ET.inviteServer,customExts:{server_id:i.id,server_name:i.name,icon:i.icon,desc:i.description}})}else{var o=v.find((function(e){return e.id===I}));r=(0,we.bD)({chatType:Ee.zi.single,type:"custom",to:e,customEvent:Ee.ET.inviteChannel,customExts:{server_id:o.id,server_name:o.name,icon:o.icon,desc:o.description,channel_id:b,channel_name:n}})}(0,we.j5)(r).then((function(){f({chatType:r.chatType,fromId:e,messageInfo:{list:[(0,s.Z)((0,s.Z)({},r),{},{from:Se.Z.conn.user})]}})}))}(e.uid,d)}}))},e.uid)})):(0,Ie.jsx)("div",{className:qe,children:"\u60a8\u8fd8\u6ca1\u6709\u597d\u53cb"})]})}))),en=t(4771),nn=function(e){var n=e.item;return(0,Ie.jsx)("div",{className:_e,children:n.tagName},n.tagId)},tn=(0,r.memo)(nn),rn="publicScrollWrap",on=R.Panel,an="TEXT",sn="DEFAULT_TEXT",ln=function(e){var n=e.setChannelVisible,t=e.selfRole;return(0,Ie.jsxs)("div",{className:$,children:[(0,Ie.jsx)("div",{className:ne,children:"\u6587\u5b57\u9891\u9053"}),t===Ee.N1.owner&&(0,Ie.jsx)(D.Z,{title:"\u521b\u5efa\u9891\u9053",overlayClassName:"toolTip",children:(0,Ie.jsx)("div",{className:J,onClick:function(e){e.stopPropagation(),n(!0)}})})]})},cn=(0,r.memo)((0,Ne.$j)((function(e){var n=e.server,t=e.app;return{joinedServerInfo:n.joinedServerInfo,channelMap:n.channelMap,currentChannelInfo:t.currentChannelInfo,serverRole:t.serverRole,tags:n.currentServerTag}}),(function(e){return{setVisible:function(n){return e({type:"channel/setVisible",payload:n})},setChannelVisible:function(n){return e({type:"channel/setChannelVisible",payload:n})},setInviteVisible:function(n){return e({type:"channel/setInviteVisible",payload:n})},setServerFormVisible:function(n){return e({type:"app/setVisible",payload:n})},setServerChannelMap:function(n){return e({type:"server/setChannelMap",payload:n})},setTags:function(n){return e({type:"server/setCurrentServerTag",payload:n})}}}))((function(e){var n,t=e.setVisible,o=e.setChannelVisible,a=e.setInviteVisible,d=e.setServerFormVisible,u=e.joinedServerInfo,h=e.channelMap,p=e.setServerChannelMap,v=e.currentChannelInfo,f=e.serverRole,m=e.tags,x=e.setTags,_=(0,r.useState)([an]),g=(0,c.Z)(_,2),y=g[0],I=g[1],b=(0,i.s0)(),C=(0,i.UO)(),Z=C.serverId,j=C.channelId,T=C.threadId,N=f&&f[Z],S=(0,r.useMemo)((function(){return function(e){var n=e.serverId,t=void 0===n?"":n,r=e.serverList,i=(void 0===r?[]:r).filter((function(e){return e.id===t}));return i.length?i[0]:{}}({serverId:Z,serverList:u.list})}),[Z,u]),w=(0,r.useMemo)((function(){return function(e){var n=e.serverId,t=void 0===n?"":n,r=e.channelMap;return(void 0===r?new Map:r).get(t)}({serverId:Z,channelMap:h})}),[h,Z]),E=S.name,k=S.description,M=void 0===k?"":k,L=w?[].concat((0,l.Z)(null===w||void 0===w?void 0:w.public),(0,l.Z)(null===w||void 0===w?void 0:w.private)):[],P=(0,r.useState)(!0),A=(0,c.Z)(P,2),D=A[0],$=A[1],J=(0,r.useCallback)((function(e){var n=e.cursor,t=void 0===n?"":n;Se.Z.conn.getPublicChannels({serverId:Z,pageSize:15,cursor:t}).then((function(e){var n=[];if(null!==w&&void 0!==w&&w.public){var t=(0,we.cm)(null===w||void 0===w?void 0:w.public,e.data.list,"channelId");n=[].concat((0,l.Z)(null===w||void 0===w?void 0:w.public),(0,l.Z)(t))}else n=e.data.list;var r={public:n,publicCursor:e.data.cursor,private:[],privateCursor:"",loadCount:e.data.list.length};e.data.list.length<15?($(!1),Se.Z.conn.getVisiblePrivateChannels({serverId:Z,pageSize:15,cursor:""}).then((function(e){var n,t=(null===w||void 0===w?void 0:w.private)||[],i=(0,we.cm)(t,e.data.list,"channelId"),o=[].concat((0,l.Z)(t),(0,l.Z)(i));p({serverId:Z,channelInfo:(0,s.Z)((0,s.Z)({},r),{},{private:o,privateCursor:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.cursor,loadCount:e.data.list.length})})}))):p({serverId:Z,channelInfo:r})}))}),[null===w||void 0===w?void 0:w.private,null===w||void 0===w?void 0:w.public,Z,p]),Q=function(e){var n=e.cursor,t=void 0===n?"":n;Se.Z.conn.getVisiblePrivateChannels({serverId:Z,pageSize:15,cursor:t}).then((function(e){var n=(null===w||void 0===w?void 0:w.private)||[],t=(0,we.cm)(n,e.data.list,"channelId"),r=[].concat((0,l.Z)(n),(0,l.Z)(t));p({serverId:Z,channelInfo:(0,s.Z)((0,s.Z)({},w),{},{private:r,privateCursor:e.data.cursor,loadCount:e.data.list.length})})}))};return(0,r.useEffect)((function(){h.has(Z)||J({cursor:""})}),[Z,h,J]),(0,r.useEffect)((function(){Se.Z.conn.getServerTags({serverId:Z}).then((function(e){x(e.data.tags)}))}),[Z]),(0,Ie.jsxs)("div",{className:Y,children:[(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsxs)("div",{className:z,style:{backgroundImage:"url(".concat((0,we.Nt)(Z),")")},children:[(0,Ie.jsx)("div",{className:V}),(0,Ie.jsxs)("div",{className:W,children:[(0,Ie.jsx)("div",{className:F,children:E}),(0,Ie.jsxs)("div",{className:B,children:[(0,Ie.jsx)("div",{className:"".concat(U),onClick:function(){a(Ee.ET.inviteServer)},children:(0,Ie.jsx)(ye.Z,{name:"person_plus",size:"28px",color:"#fff",style:{marginRight:"8px"}})}),(0,Ie.jsx)(Qe,{serverName:E,channelName:null===v||void 0===v?void 0:v.name}),(0,Ie.jsx)(De.Z,{onClick:function(e){if(e.key===Oe)o(!0);else if(e.key===Ke)b("/main/channel/".concat(Z,"/").concat(j)),T?setTimeout((function(){t(!0)}),0):t(!0);else if(e.key===Ye)d(Ee.nz.edit);else if(e.key===Ve){var n=(0,we.OK)({title:(0,Ie.jsx)("div",{style:{color:"#fff"},children:"\u9000\u51fa\u793e\u533a"}),content:(0,Ie.jsx)("div",{style:{color:"#fff",marginTop:"37px"},children:"\u786e\u8ba4\u9000\u51fa\u793e\u533a ".concat(E,"\uff1f")}),onOk:function(){Se.Z.conn.leaveServer({serverId:Z}).then((function(e){O.ZP.success("\u9000\u51fa\u793e\u533a\u6210\u529f"),(0,we.Af)(Z).then((function(e){if(e.length>0){var n=e[0],t=n.id,r=n.defaultChannelId;b("/main/channel/".concat(t,"/").concat(r))}else b("/main/contacts/index")}))}))}});Re.Z.confirm(n)}else{var r=(0,we.OK)({title:(0,Ie.jsx)("div",{style:{color:"#fff"},children:"\u89e3\u6563\u793e\u533a"}),content:(0,Ie.jsxs)("div",{style:{color:"#fff",marginTop:"37px"},children:["\u786e\u8ba4\u89e3\u6563\u793e\u533a ".concat(E,"\uff1f\u672c\u64cd\u4f5c\u4e0d\u53ef\u6062\u590d"),"\u3002"]}),onOk:function(){Se.Z.conn.destroyServer({serverId:Z}).then((function(e){O.ZP.success("\u89e3\u6563\u793e\u533a\u6210\u529f"),(0,we.Af)(Z).then((function(e){if(e.length>0){var n=e[0],t=n.id,r=n.defaultChannelId;b("/main/channel/".concat(t,"/").concat(r))}else b("/main/contacts/index")}))}))}});Re.Z.confirm(r)}},style:{padding:0},theme:"dark",selectable:!1,triggerSubMenuAction:"click",mode:"horizontal",items:(n=N,[{label:(0,Ie.jsx)("div",{className:"".concat(U),children:(0,Ie.jsx)(ye.Z,{name:"ellipsis",color:"#fff",size:"28px"})}),key:"SubMenu",children:Fe(n)}])})]})]}),(0,Ie.jsx)("div",{className:H,children:m.map((function(e){return(0,Ie.jsx)(tn,{item:e},e.tagId)}))})]}),M&&(0,Ie.jsx)(Ce,{desc:M})]}),(0,Ie.jsx)("div",{className:G,children:(0,Ie.jsxs)(R,{className:q,bordered:!1,activeKey:y,expandIcon:function(e){var n=e.isActive;return(0,Ie.jsx)(ye.Z,{iconClass:n?me:xe,name:"shevron_down",color:"#c7c7c7",size:"14px"})},onChange:function(e){null!==e&&void 0!==e&&e.length?I([an]):I([sn])},children:[(0,Ie.jsx)(on,{className:X,header:(0,Ie.jsx)(ln,{setChannelVisible:o,selfRole:N}),children:(0,Ie.jsx)("div",{id:rn,className:fe,children:(0,Ie.jsx)(en.Z,{dataLength:L.length||0,next:function(){D?J({cursor:null===w||void 0===w?void 0:w.publicCursor}):Q({cursor:null===w||void 0===w?void 0:w.privateCursor})},hasMore:15===(null===w||void 0===w?void 0:w.loadCount),loader:(0,Ie.jsx)(Ie.Fragment,{}),endMessage:(0,Ie.jsx)(Ie.Fragment,{}),scrollableTarget:rn,children:(0,Ie.jsx)(K.ZP,{dataSource:L,renderItem:function(e){return(0,Ie.jsx)(K.ZP.Item,{children:(0,r.createElement)(Ae,(0,s.Z)((0,s.Z)({},e),{},{key:e.channelId,active:!T&&j===e.channelId}))},e.channelId)}})})})},an),(0,Ie.jsx)(on,{showArrow:!1,className:X,children:(0,Ie.jsx)(K.ZP,{dataSource:[v],renderItem:function(e){return(0,Ie.jsx)(K.ZP.Item,{children:(0,r.createElement)(Ae,(0,s.Z)((0,s.Z)({},e),{},{key:e.channelId,active:!T&&j===e.channelId}))},e.channelId)}})},sn)]})})]})}))),dn=function(){return(0,Ie.jsxs)("div",{className:o,children:[(0,Ie.jsx)(cn,{}),(0,Ie.jsx)(i.j3,{})]})},un=(0,r.memo)(dn)},4771:function(e,n,t){var r=t(2791),i=function(e,n){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},i(e,n)};var o=function(){return o=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},o.apply(this,arguments)};var a="Pixel",s="Percent",l={unit:s,value:.8};function c(e){return"number"===typeof e?{unit:s,value:100*e}:"string"===typeof e?e.match(/^(\d*(\.\d+)?)px$/)?{unit:a,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:s,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),l):(console.warn("scrollThreshold should be string or number"),l)}var d=function(e){function n(n){var t=e.call(this,n)||this;return t.lastScrollTop=0,t.actionTriggered=!1,t.startY=0,t.currentY=0,t.dragging=!1,t.maxPullDownDistance=0,t.getScrollableTarget=function(){return t.props.scrollableTarget instanceof HTMLElement?t.props.scrollableTarget:"string"===typeof t.props.scrollableTarget?document.getElementById(t.props.scrollableTarget):(null===t.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},t.onStart=function(e){t.lastScrollTop||(t.dragging=!0,e instanceof MouseEvent?t.startY=e.pageY:e instanceof TouchEvent&&(t.startY=e.touches[0].pageY),t.currentY=t.startY,t._infScroll&&(t._infScroll.style.willChange="transform",t._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},t.onMove=function(e){t.dragging&&(e instanceof MouseEvent?t.currentY=e.pageY:e instanceof TouchEvent&&(t.currentY=e.touches[0].pageY),t.currentY<t.startY||(t.currentY-t.startY>=Number(t.props.pullDownToRefreshThreshold)&&t.setState({pullToRefreshThresholdBreached:!0}),t.currentY-t.startY>1.5*t.maxPullDownDistance||t._infScroll&&(t._infScroll.style.overflow="visible",t._infScroll.style.transform="translate3d(0px, "+(t.currentY-t.startY)+"px, 0px)")))},t.onEnd=function(){t.startY=0,t.currentY=0,t.dragging=!1,t.state.pullToRefreshThresholdBreached&&(t.props.refreshFunction&&t.props.refreshFunction(),t.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame((function(){t._infScroll&&(t._infScroll.style.overflow="auto",t._infScroll.style.transform="none",t._infScroll.style.willChange="unset")}))},t.onScrollListener=function(e){"function"===typeof t.props.onScroll&&setTimeout((function(){return t.props.onScroll&&t.props.onScroll(e)}),0);var n=t.props.height||t._scrollableNode?e.target:document.documentElement.scrollTop?document.documentElement:document.body;t.actionTriggered||((t.props.inverse?t.isElementAtTop(n,t.props.scrollThreshold):t.isElementAtBottom(n,t.props.scrollThreshold))&&t.props.hasMore&&(t.actionTriggered=!0,t.setState({showLoader:!0}),t.props.next&&t.props.next()),t.lastScrollTop=n.scrollTop)},t.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:n.dataLength},t.throttledOnScrollListener=function(e,n,t,r){var i,o=!1,a=0;function s(){i&&clearTimeout(i)}function l(){var l=this,c=Date.now()-a,d=arguments;function u(){a=Date.now(),t.apply(l,d)}function h(){i=void 0}o||(r&&!i&&u(),s(),void 0===r&&c>e?u():!0!==n&&(i=setTimeout(r?h:u,void 0===r?e-c:e)))}return"boolean"!==typeof n&&(r=t,t=n,n=void 0),l.cancel=function(){s(),o=!0},l}(150,t.onScrollListener).bind(t),t.onStart=t.onStart.bind(t),t.onMove=t.onMove.bind(t),t.onEnd=t.onEnd.bind(t),t}return function(e,n){function t(){this.constructor=e}i(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}(n,e),n.prototype.componentDidMount=function(){if("undefined"===typeof this.props.dataLength)throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),"number"===typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!==typeof this.props.refreshFunction))throw new Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},n.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},n.prototype.componentDidUpdate=function(e){this.props.dataLength!==e.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},n.getDerivedStateFromProps=function(e,n){return e.dataLength!==n.prevDataLength?o(o({},n),{prevDataLength:e.dataLength}):null},n.prototype.isElementAtTop=function(e,n){void 0===n&&(n=.8);var t=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,r=c(n);return r.unit===a?e.scrollTop<=r.value+t-e.scrollHeight+1:e.scrollTop<=r.value/100+t-e.scrollHeight+1},n.prototype.isElementAtBottom=function(e,n){void 0===n&&(n=.8);var t=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,r=c(n);return r.unit===a?e.scrollTop+t>=e.scrollHeight-r.value:e.scrollTop+t>=r.value/100*e.scrollHeight},n.prototype.render=function(){var e=this,n=o({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),t=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),i=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return r.createElement("div",{style:i,className:"infinite-scroll-component__outerdiv"},r.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(n){return e._infScroll=n},style:n},this.props.pullDownToRefresh&&r.createElement("div",{style:{position:"relative"},ref:function(n){return e._pullDown=n}},r.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!t&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},n}(r.Component);n.Z=d}}]);
//# sourceMappingURL=275.493824b6.chunk.js.map